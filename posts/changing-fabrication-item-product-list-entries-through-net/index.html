<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Changing Fabrication Item Product List Entries Through .NET" /><meta name="author" content="Skylar Daniels" /><meta property="og:locale" content="en_US" /><meta name="description" content="A few months ago there was an occasion where a colleague needed to swap out some clamps that were product listed for a different size. The simplest method would have been to just do a swap in, but the problem with that method was that the clamps had unique spool names and custom data that would be overwritten if a swap in was performed. This made me decide to look into changing a Job Item product list line entry through the Fabrication .NET API. For more information about getting started with Fabrications Items through the .NET API see the post [Accessing Fabrication Items Through .NET]/posts/accessing-fabricaton-items-through-net/." /><meta property="og:description" content="A few months ago there was an occasion where a colleague needed to swap out some clamps that were product listed for a different size. The simplest method would have been to just do a swap in, but the problem with that method was that the clamps had unique spool names and custom data that would be overwritten if a swap in was performed. This made me decide to look into changing a Job Item product list line entry through the Fabrication .NET API. For more information about getting started with Fabrications Items through the .NET API see the post [Accessing Fabrication Items Through .NET]/posts/accessing-fabricaton-items-through-net/." /><link rel="canonical" href="/posts/changing-fabrication-item-product-list-entries-through-net/" /><meta property="og:url" content="/posts/changing-fabrication-item-product-list-entries-through-net/" /><meta property="og:site_name" content="House of BIM" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2017-05-05T10:57:00-07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Changing Fabrication Item Product List Entries Through .NET" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Changing Fabrication Item Product List Entries Through .NET","dateModified":"2017-05-05T10:57:00-07:00","datePublished":"2017-05-05T10:57:00-07:00","description":"A few months ago there was an occasion where a colleague needed to swap out some clamps that were product listed for a different size. The simplest method would have been to just do a swap in, but the problem with that method was that the clamps had unique spool names and custom data that would be overwritten if a swap in was performed. This made me decide to look into changing a Job Item product list line entry through the Fabrication .NET API. For more information about getting started with Fabrications Items through the .NET API see the post [Accessing Fabrication Items Through .NET]/posts/accessing-fabricaton-items-through-net/.","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/changing-fabrication-item-product-list-entries-through-net/"},"url":"/posts/changing-fabrication-item-product-list-entries-through-net/","@type":"BlogPosting","author":{"@type":"Person","name":"Skylar Daniels"},"@context":"https://schema.org"}</script><title>Changing Fabrication Item Product List Entries Through .NET | House of BIM</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end">
<div class="profile-wrapper text-center">
<div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/favicon-96x96.png" alt="avatar" onerror="this.style.display='none'"> </a>
</div>
<div class="site-title mt-3"> <a href="/">House of BIM</a>
</div>
<div class="site-subtitle font-italic">Stuff and Things...it's what we do</div>
</div>
<ul class="w-100">
<li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a>
</li>
<li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a>
</li>
<li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a>
</li>
<li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-database ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a>
</li>
<li class="nav-item"> <a href="/links/" class="nav-link"> <i class="fa-fw fa fa-link ml-xl-3 mr-xl-3 unloaded"></i> <span>LINKS</span> </a>
</li>
<li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fa fa-question ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a>
</li>
</ul>
<div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/AHepker-HOB" aria-label="github" class="order-3" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/andrew-hepker-738b0b80/" aria-label="linkedin" class="order-4" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="javascript:location.href=%5B'mailto:',%20'andrew',%20'.',%20'hepker',%20'@house',%20'ofbim.com'%5D.join('')" aria-label="email" class="order-5"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6"> <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span>
</div>
</div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Changing Fabrication Item Product List Entries Through .NET</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div>
<i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel">Cancel</span>
</div></div><div id="main-wrapper">
<div id="main">
<div class="row">
<div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
<h1 data-toc-skip>Changing Fabrication Item Product List Entries Through .NET</h1>
<div class="post-meta text-muted d-flex flex-column">
<div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, May 5, 2017, 10:57 AM -0700"> May 5, 2017 <i class="unloaded">2017-05-05T10:57:00-07:00</i> </span> by <span class="author"> Skylar Daniels </span>
</div>
<div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="681 words">3 min</span>
</div>
</div>
<div class="post-content">
<p>A few months ago there was an occasion where a colleague needed to swap out some clamps that were product listed for a different size. The simplest method would have been to just do a swap in, but the problem with that method was that the clamps had unique spool names and custom data that would be overwritten if a swap in was performed. This made me decide to look into changing a Job Item product list line entry through the Fabrication .NET API. For more information about getting started with Fabrications Items through the .NET API see the post [Accessing Fabrication Items Through .NET]/posts/accessing-fabricaton-items-through-net/.</p>
<p>The code below has the user select some fabrication objects, then displays a dialog with a drop down of all unique Product List names within the user selection. The user then selects a name from the drop down and hits “OK”. The selected items that have that product list name entry are then updated. It should be noted that the items will not be dynamically stretched/relocated like they would if you used “revdesign” to updated items with Design Line, so you would need to go back through and make any adjustments where needed. The benefit would be the fact that unlike Design Line, all of the user imputed data like “Spool Name” will not be overwritten.</p>
<p><a href="/assets/dotnet/changeproductlistname2.zip">Click here to download</a> the AutoCAD/Fabrication 2017 .dll<br> Load using the “NETLOAD” command, and type “ChangePLName” to start command</p>
<div class="language-c# highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
</pre></td>
<td class="rouge-code"><pre><span class="c1">// SDaniels HOB 01.08.2017</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Autodesk.AutoCAD.Runtime</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Autodesk.AutoCAD.ApplicationServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Autodesk.AutoCAD.DatabaseServices</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Autodesk.AutoCAD.EditorInput</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Autodesk.Fabrication</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ChangeProductListName</span>
<span class="p">{</span>
    <span class="c1">//This class needed to load the Fabrication .dll</span>
    <span class="c1">//See "Accessing Fabrication Items Through .NET" post for more info</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">MyPlugin</span> <span class="p">:</span> <span class="n">IExtensionApplication</span>
    <span class="p">{</span>
        <span class="k">void</span> <span class="n">IExtensionApplication</span><span class="p">.</span><span class="nf">Initialize</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="n">Reflection</span><span class="p">.</span><span class="n">Assembly</span><span class="p">.</span><span class="nf">LoadFrom</span><span class="p">(</span><span class="s">"C:\\Program Files\\Autodesk\\Fabrication 2017\\CADmep\\FabricationAPI.dll"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">void</span> <span class="n">IExtensionApplication</span><span class="p">.</span><span class="nf">Terminate</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">MyCommands</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">plNames</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>

        <span class="p">[</span><span class="nf">CommandMethod</span><span class="p">(</span><span class="s">"ChangePLName"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">MyCommand</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Document</span> <span class="n">doc</span> <span class="p">=</span> <span class="n">Autodesk</span><span class="p">.</span><span class="n">AutoCAD</span><span class="p">.</span><span class="n">ApplicationServices</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="n">DocumentManager</span><span class="p">.</span><span class="n">MdiActiveDocument</span><span class="p">;</span>
            <span class="n">Database</span> <span class="n">db</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">Database</span><span class="p">;</span>
            <span class="n">Editor</span> <span class="n">ed</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">Editor</span><span class="p">;</span>

            <span class="n">Form1</span> <span class="n">form1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Form1</span><span class="p">();</span>

            <span class="n">ObjectIdCollection</span> <span class="n">oIdC</span><span class="p">;</span>

            <span class="n">List</span><span class="p">&lt;</span><span class="n">Item</span><span class="p">&gt;</span> <span class="n">selectedItems</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Item</span><span class="p">&gt;();</span>

            <span class="c1">//Get selection based on fabrication parts</span>
            <span class="n">TypedValue</span><span class="p">[]</span> <span class="n">typArray</span> <span class="p">=</span> <span class="k">new</span> <span class="n">TypedValue</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
            <span class="n">typArray</span><span class="p">.</span><span class="nf">SetValue</span><span class="p">(</span><span class="k">new</span> <span class="nf">TypedValue</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">DxfCode</span><span class="p">.</span><span class="n">Start</span><span class="p">,</span> <span class="s">"MAPS_SOLID"</span><span class="p">),</span> <span class="m">0</span><span class="p">);</span>
            <span class="n">SelectionFilter</span> <span class="n">sf</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SelectionFilter</span><span class="p">(</span><span class="n">typArray</span><span class="p">);</span>
            <span class="n">PromptSelectionResult</span> <span class="n">res</span> <span class="p">=</span> <span class="n">ed</span><span class="p">.</span><span class="nf">GetSelection</span><span class="p">();</span>

            <span class="c1">//If user presses enter, iterate through selection and compose a list for the drop down of unique Product list names</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">Status</span> <span class="p">==</span> <span class="n">PromptStatus</span><span class="p">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">oIdC</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ObjectIdCollection</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="n">Value</span><span class="p">.</span><span class="nf">GetObjectIds</span><span class="p">());</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">oIdC</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">try</span>
                    <span class="p">{</span>
                        <span class="k">foreach</span> <span class="p">(</span><span class="n">ObjectId</span> <span class="n">id</span> <span class="k">in</span> <span class="n">oIdC</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="k">using</span> <span class="p">(</span><span class="n">Transaction</span> <span class="n">tr</span> <span class="p">=</span> <span class="n">doc</span><span class="p">.</span><span class="n">Database</span><span class="p">.</span><span class="n">TransactionManager</span><span class="p">.</span><span class="nf">StartTransaction</span><span class="p">())</span>
                            <span class="p">{</span>
                                <span class="n">Entity</span> <span class="n">ent</span> <span class="p">=</span> <span class="n">tr</span><span class="p">.</span><span class="nf">GetObject</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="n">OpenMode</span><span class="p">.</span><span class="n">ForRead</span><span class="p">)</span> <span class="k">as</span> <span class="n">Entity</span><span class="p">;</span>
                                <span class="k">if</span> <span class="p">(</span><span class="n">ent</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                                <span class="p">{</span>
                                    <span class="n">Item</span> <span class="n">item</span> <span class="p">=</span> <span class="n">Job</span><span class="p">.</span><span class="nf">GetFabricationItemFromACADHandle</span><span class="p">(</span><span class="n">ent</span><span class="p">.</span><span class="n">Handle</span><span class="p">.</span><span class="nf">ToString</span><span class="p">());</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="n">item</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                                    <span class="p">{</span>
                                        <span class="n">ItemProductList</span> <span class="n">ipl</span> <span class="p">=</span> <span class="n">item</span><span class="p">.</span><span class="n">ProductList</span> <span class="k">as</span> <span class="n">ItemProductList</span><span class="p">;</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="n">ipl</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                                        <span class="p">{</span>
                                            <span class="n">selectedItems</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

                                            <span class="k">foreach</span> <span class="p">(</span><span class="n">ItemProductListDataRow</span> <span class="n">ipdr</span> <span class="k">in</span> <span class="n">ipl</span><span class="p">.</span><span class="n">Rows</span><span class="p">)</span>
                                            <span class="p">{</span>
                                                <span class="k">if</span> <span class="p">(!</span><span class="n">form1</span><span class="p">.</span><span class="n">cmbNames</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="n">ipdr</span><span class="p">.</span><span class="n">Name</span><span class="p">))</span>
                                                <span class="p">{</span>
                                                    <span class="n">form1</span><span class="p">.</span><span class="n">cmbNames</span><span class="p">.</span><span class="n">Items</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">ipdr</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
                                                <span class="p">}</span>
                                            <span class="p">}</span>
                                        <span class="p">}</span>
                                    <span class="p">}</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                    <span class="k">catch</span> <span class="p">{</span> <span class="p">}</span>
                    
                    <span class="n">Autodesk</span><span class="p">.</span><span class="n">AutoCAD</span><span class="p">.</span><span class="n">ApplicationServices</span><span class="p">.</span><span class="n">Application</span><span class="p">.</span><span class="nf">ShowModalDialog</span><span class="p">(</span><span class="k">null</span><span class="p">,</span> <span class="n">form1</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">form1</span><span class="p">.</span><span class="n">ok</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">List</span><span class="p">&lt;</span><span class="n">Item</span><span class="p">&gt;</span> <span class="n">itemUpdatedList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Item</span><span class="p">&gt;();</span>

                        <span class="k">foreach</span> <span class="p">(</span><span class="n">Item</span> <span class="n">item</span> <span class="k">in</span> <span class="n">selectedItems</span><span class="p">)</span>
                        <span class="p">{</span>
                            <span class="n">ItemProductList</span> <span class="n">ipl</span> <span class="p">=</span> <span class="n">item</span><span class="p">.</span><span class="n">ProductList</span> <span class="k">as</span> <span class="n">ItemProductList</span><span class="p">;</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">ipl</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                            <span class="p">{</span>
                                <span class="kt">int</span> <span class="n">ct</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

                                <span class="k">foreach</span> <span class="p">(</span><span class="n">ItemProductListDataRow</span> <span class="n">ipdr</span> <span class="k">in</span> <span class="n">ipl</span><span class="p">.</span><span class="n">Rows</span><span class="p">)</span>
                                <span class="p">{</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="n">ipdr</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="n">form1</span><span class="p">.</span><span class="n">cmbNames</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span>
                                    <span class="p">{</span>
                                        <span class="n">itemUpdatedList</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
                                        <span class="n">item</span><span class="p">.</span><span class="nf">LoadProductListEntry</span><span class="p">(</span><span class="n">ct</span><span class="p">);</span>
                                        <span class="n">item</span><span class="p">.</span><span class="nf">Update</span><span class="p">();</span>
                                        <span class="k">break</span><span class="p">;</span>
                                    <span class="p">}</span>
                                    <span class="n">ct</span><span class="p">++;</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="c1">//Update the item UI view</span>
                        <span class="c1">//Without this, the item won't depict the updated productlist entry unless double clicked on.</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">itemUpdatedList</span><span class="p">.</span><span class="n">Count</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                            <span class="n">Autodesk</span><span class="p">.</span><span class="n">Fabrication</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">UIApplication</span><span class="p">.</span><span class="nf">UpdateView</span><span class="p">(</span><span class="n">itemUpdatedList</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td>
</tr></tbody></table></code></div></div>
<p>Thank you for taking the time to read this post and please leave a comment below with any questions or feedback.</p>
</div>
<div class="post-tail-wrapper text-muted">
<div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href="/categories/net/">.NET</a>, <a href="/categories/fabrication-cadmep/">Fabrication CADmep</a>
</div>
<div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/fabrication-api/" class="post-tag no-text-decoration">Fabrication API</a> <a href="/tags/lisp/" class="post-tag no-text-decoration">Lisp</a> <a href="/tags/product-list/" class="post-tag no-text-decoration">Product List</a>
</div>
<div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
<div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer">CC BY 4.0</a> by the author.</div>
<div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span>
</div>
</div>
</div>
</div></div>
<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access">
<div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/accessing-fabricaton-items-through-net/">Accessing Fabricaton Items Through .NET</a></li></ul>
</div>
<div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/autocad/">AutoCAD</a> <a class="post-tag" href="/tags/fabrication/">Fabrication</a> <a class="post-tag" href="/tags/vla/">VLA</a> <a class="post-tag" href="/tags/lisp/">Lisp</a> <a class="post-tag" href="/tags/visual-lisp/">Visual Lisp</a> <a class="post-tag" href="/tags/activex/">ActiveX</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/cadmep/">cadMEP</a> <a class="post-tag" href="/tags/command/">command</a> <a class="post-tag" href="/tags/fabrication-api/">Fabrication API</a>
</div>
</div>
</div></div>
</div>
<div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4">
<div id="related-posts" class="mt-5 mb-2 mb-sm-4">
<h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3>
<div class="card-deck mb-4">
<div class="card"> <a href="/posts/accessing-fabricaton-items-through-net/"><div class="card-body"> <span class="timeago small"> Jan 14, 2017 <i class="unloaded">2017-01-14T13:28:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Accessing Fabricaton Items Through .NET</h3>
<div class="text-muted small"><p> Like AutoCAD, Fabrication MEP has its own API that can be used to read/write properties, and access different Fabrication objects.  If you have used .NET to create commands for AutoCAD in the past ...</p></div>
</div></a>
</div>
<div class="card"> <a href="/posts/fabwrapper-lisp-wrapper-of-the-autodesk-fabrication-net-api-alpha-release/"><div class="card-body"> <span class="timeago small"> Aug 8, 2017 <i class="unloaded">2017-08-08T15:47:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>FabWrapper - lisp wrapper of the Autodesk Fabrication .Net API - Alpha Release</h3>
<div class="text-muted small"><p> UPDATE!!! This post is the legacy code from 2017. For the latest code and write-up, please visit the updated post on Josh’s site. https://www.ifnullthen.com/posts/FabWrapper/ Legacy Post Wra...</p></div>
</div></a>
</div>
<div class="card"> <a href="/posts/notepad-udl-highlighting-for-cod-dcl-languages/"><div class="card-body"> <span class="timeago small"> Mar 23, 2019 <i class="unloaded">2019-03-23T21:32:00-07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Notepad++ UDL Highlighting for COD &amp; DCL Languages</h3>
<div class="text-muted small"><p> Dialog Control Language UDL We had a DLL AutoCAD command that we lost the code to quite some time ago and wanted to “update” its functionality. We could have done this through lisp quite easily, bu...</p></div>
</div></a>
</div>
</div>
</div>
<div class="post-navigation d-flex justify-content-between"> <a href="/posts/pipe-nesting-another-cadmep-vla-example/" class="btn btn-outline-primary" prompt="Older"><p>Pipe Nesting - Another CADmep VLA Example</p></a> <a href="/posts/using-the-autodesk-material-libraries-to-style-fabrication-or-plant-3d-services/" class="btn btn-outline-primary" prompt="Newer"><p>Using the Autodesk Material Libraries to style Fabrication or Plant 3D Services</p></a>
</div>
</div></div></div>
<footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center">
<div class="footer-left"><p class="mb-0"> © 2022 <a href="https://www.linkedin.com/in/andrew-hepker-738b0b80/" target="_blank" rel="noopener noreferrer">House of BIM</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div>
<div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener noreferrer">Chirpy</a> theme.</p></div>
</div></footer>
</div>
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content">
<div id="search-hints">
<h4 class="text-muted mb-4">Trending Tags</h4>
<a class="post-tag" href="/tags/autocad/">AutoCAD</a> <a class="post-tag" href="/tags/fabrication/">Fabrication</a> <a class="post-tag" href="/tags/vla/">VLA</a> <a class="post-tag" href="/tags/lisp/">Lisp</a> <a class="post-tag" href="/tags/visual-lisp/">Visual Lisp</a> <a class="post-tag" href="/tags/activex/">ActiveX</a> <a class="post-tag" href="/tags/automation/">Automation</a> <a class="post-tag" href="/tags/cadmep/">cadMEP</a> <a class="post-tag" href="/tags/command/">command</a> <a class="post-tag" href="/tags/fabrication-api/">Fabrication API</a>
</div>
<div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
</div></div>
</div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
